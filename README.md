# API Documentation

## 1️⃣ API Specification

| 구분 | 화면 | 필요권한 | Method | Description | 요청 URL | Request JSON |
| --- | --- | --- | --- | --- | --- | --- |
| 관리 및 공통 | 로그인 | 관리자 | POST | 관리자 페이지 로그인 | `/api/admin/login` | `{"id": "{id}", "password": "{password}"}` |
|  |  | 사용자 | POST | 사용자 게시판 서비스 로그인 | `/api/user/login` | `{"id": "{id}", "password": "{password}"}` |
|  | 유저 관리 | 관리자 | GET | 전체 사용자 목록 조회 | `/api/admin/users` | `{}` |
|  |  | 관리자 | POST | 사용자 생성 | `/api/admin/users` | `{"id": "{id}", "password": "{password}", "name": "{name}"}` |
|  |  | 관리자 | PATCH | 사용자 정보 수정 | `/api/admin/users/{userId}` | `{"id": "{id}", "password": "{password}", "name": "{name}"}` |
|  |  | 관리자 | DELETE | 사용자 삭제 | `/api/admin/users/{userId}` | `{}` |
|  |  | 관리자 | GET | 사용자 비밀번호 초기화 | `/api/admin/users/{userId}/password` | `{}` |
|  |  | 관리자 | POST | 사용자 권한 부여 | `/api/admin/users/{userId}/roles` | `{"grantRoleList": [{"role": "ADMIN"}, {"role": "USER"}]}` |

## 2️⃣ 요구사항

**관리 및 공통**

- `관리자`는 관리자 페이지에 `로그인` 할 수 있다 - **Method Return Type (String - default(”jwttoken”))**
    - 관리자 페이지 로그인시, `아이디`와 `비밀번호`로 회원 조회 후 관리자가 아닐경우 “관리자 권한이 없습니다. 관리자 페이지에 진입할 수 없습니다.” 에러 표시가 필요하다.
    - `아이디`와 `비밀번호`가 틀린 경우 “아이디 또는 비밀번호가 다릅니다.” 에러 표시가 필요하다.
    - 회원 조회시 없는 회원인 경우 “존재하지 않는 회원입니다.” 에러 표시가 필요하다.

- `사용자`는 게시판 서비스에 `로그인` 할 수 있다 - **Method Return Type (String)**
    - `아이디`와 `비밀번호`가 틀린 경우 “아이디 또는 비밀번호가 다릅니다.” 에러 표시가 필요하다.

- `관리자`는 회원 목록 페이지에서 전체 `사용자 목록`을 `확인`할 수 있다 - **Method Return Type (List<MemberDto>)**
    - 현재 `Presentation Layer`에서 권한 처리가 되어 있지 않으므로, **전체 사용자 목록만 조회되면 된다.**

- `관리자`는 회원 관리 페이지에서 `사용자 계정`을 생성할 수 있다 - **Method Return Type (Long - MemberId)**
    - `사용자`를 생성할 경우, 이미 존재하는 `ID`로 가입 시도를 하는 경우 “이미 가입된 ID 입니다.” 에러 표시가 필요하다.
    - 사용자를 생성할 때 비밀번호는 `Bcrypt 암호화 처리`가 필요하다.
    
- `관리자`는 회원 관리 페이지에서 `사용자 계정`을 `수정`할 수 있다 - **Method Return Type (void)**
    - `사용자`를 수정할 경우, 이미 존재하는 `ID`로 수정 시도를 하는 경우  `"중복된 ID로 정보 변경은 불가능합니다."` 에러 표시가 필요하다.
    - 수정에 성공한다면, `DB`에 `반영` 되어야 한다.

- `관리자`는 회원 관리 페이지에서 `사용자 계정`을 `삭제`할 수 있다 - **Method Return Type (void)**
    - `사용자`를 `삭제`할 경우, 없는 회원의 `PK`가 `Path Variable`로 들어오면 “존재하지 않는 회원은 삭제할 수 없습니다.” 에러 표시가 필요하다.
    - 사용자 삭제는 `Hard Delete`로 처리한다.
    - 삭제에 성공할 경우 `DB`에 `반영`되어야 한다.
    - 계정 삭제시, 테이블과 `User_Role` 테이블의 데이터도 **함께 삭제되어야 한다.**

- `관리자`는 회원 관리 페이지에서 사용자의 `패스워드`를 `초기화` 할 수 있다 - **Method Return Type (String -  초기화 된 비밀번호)**
    - `사용자`를 조회할 때 없는 사용자라면 “존재하지 않는 회원의 비밀번호는 초기화할 수 없습니다.” 에러 표시가 필요하다.
    - `초기화` 할 패스워드는 `UUID`를 생성하여 초기화하며, `암호화`해서 회원 정보를 업데이트 해야 한다.

- `관리자`는 사용자에게 다양한  `권한`을 부여할 수 있다 - **Method Return Type (void)**
    - `부여`하려는 `권한`이 존재하지 않거나, `권한`을 `부여`하려는 사용자가 없는 사용자라면 “유효하지 않은 권한 부여 시도는 허용되지 않습니다.”, “존재하지 않는 회원에게 권한을 부여할 수 없습니다.” 에러 메시지를 **각각 표시한다.**
    - `사용자`는 여러 권한을 동시에 가질 수 있으므로, `Role`을 `List`로 받아서 저장되어야 한다.
    - 권한은 `Role` 테이블에 저장되며 `User`와 `Role` 사이의 `Join Table`인 `User_Role` 테이블에 권한과 유저를 매핑해준다.


